{% extends 'boxing_app/base.html' %}
{% load static %}

{% block page_title %}BMI Calculator - Boxing Fitness{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="section-dark py-20 px-6 full-width relative overflow-hidden">
    <!-- Animated Background -->
    <div class="absolute inset-0 opacity-10">
        <div class="absolute top-0 left-0 w-32 h-32 bg-accent-red rounded-full blur-xl animate-float"></div>
        <div class="absolute bottom-0 right-0 w-48 h-48 bg-accent-red rounded-full blur-xl animate-float" style="animation-delay: 2s;"></div>
        <div class="absolute top-1/2 left-1/4 w-24 h-24 bg-accent-red rounded-full blur-lg animate-float" style="animation-delay: 1s;"></div>
    </div>
    
    <div class="content-container mx-auto relative z-10">
        <div class="text-center transform-gpu">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 text-white opacity-0 translate-y-10 animate-fade-in-up">
                BMI <span class="text-accent-red">CALCULATOR</span>
            </h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto opacity-0 translate-y-10 animate-fade-in-up" style="animation-delay: 0.3s;">
                Calculate your Body Mass Index and discover your ideal fighting weight
            </p>
        </div>
    </div>
</section>

<!-- BMI Calculator Content -->
<section class="section-black py-16 px-6 full-width relative overflow-hidden">
    <!-- Background Elements -->
    <div class="absolute inset-0 opacity-5">
        <div class="absolute top-10 left-10 w-20 h-20 bg-accent-red rounded-full blur-xl animate-float"></div>
        <div class="absolute bottom-10 right-10 w-32 h-32 bg-accent-red rounded-full blur-xl animate-float" style="animation-delay: 2s;"></div>
        <div class="absolute top-1/2 left-1/3 w-16 h-16 bg-light-red rounded-full blur-xl animate-float" style="animation-delay: 1s;"></div>
    </div>
    
    <div class="content-container mx-auto relative z-10">
        <!-- BMI Info -->
        {% if bmi_info and bmi_info.description %}
        <div class="mb-12 opacity-0 translate-y-10">
            <div class="card-pro group p-8 transform-gpu hover:scale-105 transition-all duration-500">
                <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-br from-accent-red to-light-red flex items-center justify-center shadow-lg shadow-accent-red/30 group-hover:shadow-accent-red/50 transition-all duration-300 group-hover:scale-110 group-hover:rotate-12">
                    <i class="fas fa-heartbeat text-white text-xl"></i>
                </div>
                
                <h2 class="text-2xl text-center text-white mb-4 group-hover:text-accent-red transition-colors duration-300 transform group-hover:translate-y-1">
                    About BMI
                </h2>
                
                <p class="text-gray-300 text-lg leading-relaxed text-center">
                    {{ bmi_info.description }}
                </p>
            </div>
        </div>
        {% endif %}

        <!-- Calculator Form -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
            <!-- Calculator Card -->
            <div class="card-pro group p-8 transform-gpu hover:scale-105 transition-all duration-500 opacity-0 translate-y-20">
                <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-br from-accent-red to-light-red flex items-center justify-center shadow-lg shadow-accent-red/30 group-hover:shadow-accent-red/50 transition-all duration-300 group-hover:scale-110 group-hover:rotate-12">
                    <i class="fas fa-calculator text-white text-xl"></i>
                </div>
                
                <h2 class="text-2xl text-center text-white mb-8 group-hover:text-accent-red transition-colors duration-300 transform group-hover:translate-y-1">
                    Calculate Your BMI
                </h2>
                
                <form method="POST" class="space-y-6">
                    {% csrf_token %}
                    
                    <!-- Weight Input -->
                    <div class="space-y-2">
                        <label for="weight" class="text-white font-semibold flex items-center transform transition-all duration-300 group-hover:translate-x-2">
                            <i class="fas fa-weight text-accent-red mr-2"></i>
                            Weight (kg)
                        </label>
                        <input 
                            type="number" 
                            id="weight" 
                            name="weight" 
                            step="0.1" 
                            min="1" 
                            max="300"
                            required 
                            class="w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-accent-red focus:ring-2 focus:ring-accent-red/20 transition-all duration-300 transform hover:scale-105"
                            placeholder="Enter your weight in kilograms"
                        >
                    </div>
                    
                    <!-- Height Input -->
                    <div class="space-y-2">
                        <label for="height" class="text-white font-semibold flex items-center transform transition-all duration-300 group-hover:translate-x-2">
                            <i class="fas fa-ruler-vertical text-accent-red mr-2"></i>
                            Height (cm)
                        </label>
                        <input 
                            type="number" 
                            id="height" 
                            name="height" 
                            step="0.1" 
                            min="1" 
                            max="300"
                            required 
                            class="w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-accent-red focus:ring-2 focus:ring-accent-red/20 transition-all duration-300 transform hover:scale-105"
                            placeholder="Enter your height in centimeters"
                        >
                    </div>
                    
                    <!-- Calculate Button -->
                    <button 
                        type="submit" 
                        class="btn-pro w-full text-lg py-4 mt-6 transform transition-all duration-500 hover:scale-105 hover:rotate-1"
                    >
                        <i class="fas fa-calculator mr-2"></i>
                        Calculate BMI
                    </button>
                </form>
            </div>

            <!-- Results & Info -->
            <div class="space-y-6">
                {% if bmi %}
                <!-- Results Card -->
                <div class="card-pro group p-8 transform-gpu hover:scale-105 transition-all duration-500 opacity-0 translate-y-20" style="animation-delay: 0.2s;">
                    <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-br from-accent-red to-light-red flex items-center justify-center shadow-lg shadow-accent-red/30 group-hover:shadow-accent-red/50 transition-all duration-300 group-hover:scale-110 group-hover:rotate-12">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    
                    <h2 class="text-2xl text-center text-white mb-6 group-hover:text-accent-red transition-colors duration-300 transform group-hover:translate-y-1">
                        Your Results
                    </h2>
                    
                    <!-- BMI Value with Color Coding -->
                    <div class="text-center mb-6">
                        <p class="text-gray-400 mb-2 transform transition-all duration-300 group-hover:translate-x-2">Your BMI Score</p>
                        <div class="text-5xl font-bold mb-2 transform transition-all duration-500 group-hover:scale-110
                            {% if bmi < 18.5 %}text-blue-400
                            {% elif bmi < 25 %}text-green-400
                            {% elif bmi < 30 %}text-yellow-400
                            {% else %}text-accent-red
                            {% endif %}">
                            {{ bmi }}
                        </div>
                        <div class="inline-block px-4 py-2 rounded-full font-semibold text-sm transform transition-all duration-300 group-hover:scale-110 group-hover:rotate-2
                            {% if bmi < 18.5 %}bg-blue-500/20 text-blue-400 border border-blue-500/30
                            {% elif bmi < 25 %}bg-green-500/20 text-green-400 border border-green-500/30
                            {% elif bmi < 30 %}bg-yellow-500/20 text-yellow-400 border border-yellow-500/30
                            {% else %}bg-accent-red/20 text-accent-red border border-accent-red/30
                            {% endif %}">
                            {{ category }}
                        </div>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="mb-6">
                        <div class="flex justify-between text-gray-400 text-sm mb-2 transform transition-all duration-300 group-hover:translate-x-1">
                            <span>Underweight</span>
                            <span>Normal</span>
                            <span>Overweight</span>
                            <span>Obese</span>
                        </div>
                        <div class="w-full bg-white/10 rounded-full h-3 relative transform transition-all duration-300 group-hover:scale-105">
                            <div class="absolute top-0 left-0 w-1/4 h-3 bg-blue-400 rounded-l-full"></div>
                            <div class="absolute top-0 left-1/4 w-1/4 h-3 bg-green-500"></div>
                            <div class="absolute top-0 left-2/4 w-1/4 h-3 bg-yellow-500"></div>
                            <div class="absolute top-0 left-3/4 w-1/4 h-3 bg-accent-red rounded-r-full"></div>
                            
                            <!-- BMI Indicator -->
                                            <!-- <div class="absolute top-1/2 -translate-y-1/2 w-4 h-6 bg-white border-2 border-secondary-black rounded-sm shadow-lg transition-all duration-500 group-hover:scale-125"
                                                    style="left: {% widthratio bmi 40 100 %}; margin-left: -8px;">
                                            </div> -->

                        </div>
                        <div class="flex justify-between text-gray-400 text-xs mt-1 transform transition-all duration-300 group-hover:translate-x-1">
                            <span>18.5</span>
                            <span>25</span>
                            <span>30</span>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- BMI Categories Info -->
                <div class="card-pro group p-6 transform-gpu hover:scale-105 transition-all duration-500 opacity-0 translate-y-20" style="animation-delay: 0.4s;">
                    <h3 class="text-xl text-center text-white mb-4 group-hover:text-accent-red transition-colors duration-300 transform group-hover:translate-y-1">
                        BMI Categories
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 rounded-lg bg-blue-500/10 border border-blue-500/20 transform transition-all duration-300 hover:scale-105 hover:translate-x-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-blue-400 rounded-full mr-3 transform transition-all duration-300 group-hover:scale-125"></div>
                                <span class="text-white">Underweight</span>
                            </div>
                            <span class="text-blue-400 text-sm transform transition-all duration-300 group-hover:scale-110">&lt; 18.5</span>
                        </div>
                        
                        <div class="flex items-center justify-between p-3 rounded-lg bg-green-500/10 border border-green-500/20 transform transition-all duration-300 hover:scale-105 hover:translate-x-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-3 transform transition-all duration-300 group-hover:scale-125"></div>
                                <span class="text-white">Normal weight</span>
                            </div>
                            <span class="text-green-400 text-sm transform transition-all duration-300 group-hover:scale-110">18.5 - 24.9</span>
                        </div>
                        
                        <div class="flex items-center justify-between p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20 transform transition-all duration-300 hover:scale-105 hover:translate-x-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-3 transform transition-all duration-300 group-hover:scale-125"></div>
                                <span class="text-white">Overweight</span>
                            </div>
                            <span class="text-yellow-400 text-sm transform transition-all duration-300 group-hover:scale-110">25 - 29.9</span>
                        </div>
                        
                        <div class="flex items-center justify-between p-3 rounded-lg bg-accent-red/10 border border-accent-red/20 transform transition-all duration-300 hover:scale-105 hover:translate-x-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-accent-red rounded-full mr-3 transform transition-all duration-300 group-hover:scale-125"></div>
                                <span class="text-white">Obese</span>
                            </div>
                            <span class="text-accent-red text-sm transform transition-all duration-300 group-hover:scale-110">â‰¥ 30</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Recommendations -->
        {% if bmi %}
        <div class="mt-12 opacity-0 translate-y-10" style="animation-delay: 0.6s;">
            <div class="card-pro group p-8 transform-gpu hover:scale-105 transition-all duration-500">
                <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-br from-accent-red to-light-red flex items-center justify-center shadow-lg shadow-accent-red/30 group-hover:shadow-accent-red/50 transition-all duration-300 group-hover:scale-110 group-hover:rotate-12">
                    <i class="fas fa-dumbbell text-white text-xl"></i>
                </div>
                
                <h2 class="text-2xl text-center text-white mb-6 group-hover:text-accent-red transition-colors duration-300 transform group-hover:translate-y-1">
                    Training Recommendations
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center transform transition-all duration-500 hover:scale-110">
                        <i class="fas fa-running text-3xl text-accent-red mb-3 animate-pulse"></i>
                        <h4 class="text-white mb-2 transform transition-all duration-300 group-hover:translate-y-1">Cardio Training</h4>
                        <p class="text-gray-300 text-sm">
                            {% if bmi >= 25 %}
                            High-intensity interval training to boost metabolism
                            {% else %}
                            Maintain with regular cardio sessions
                            {% endif %}
                        </p>
                    </div>
                    
                    <div class="text-center transform transition-all duration-500 hover:scale-110">
                        <i class="fas fa-weight-hanging text-3xl text-accent-red mb-3 animate-pulse"></i>
                        <h4 class="text-white mb-2 transform transition-all duration-300 group-hover:translate-y-1">Strength Training</h4>
                        <p class="text-gray-300 text-sm">
                            {% if bmi < 18.5 %}
                            Focus on muscle building with compound exercises
                            {% else %}
                            Maintain muscle mass with resistance training
                            {% endif %}
                        </p>
                    </div>
                </div>
                
                <div class="text-center mt-6">
                    <a href="{% url 'training_schedule' %}" class="btn-pro transform transition-all duration-500 hover:scale-110 hover:rotate-1">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        View Training Schedule
                    </a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Enhanced GSAP Animations -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        gsap.registerPlugin(ScrollTrigger);
        
        // Hero section animations
        gsap.to('.animate-fade-in-up', {
            opacity: 1,
            y: 0,
            duration: 1,
            stagger: 0.2,
            ease: "power2.out"
        });

        // Card animations
        gsap.utils.toArray('.opacity-0').forEach((element, index) => {
            gsap.to(element, {
                opacity: 1,
                y: 0,
                duration: 1,
                delay: index * 0.1,
                scrollTrigger: {
                    trigger: element,
                    start: "top 85%",
                    end: "bottom 20%",
                    toggleActions: "play none none reverse"
                }
            });
        });

        // Input focus animations
        const inputs = document.querySelectorAll('input[type="number"]');
        inputs.forEach(input => {
            input.addEventListener('focus', () => {
                gsap.to(input, {
                    scale: 1.02,
                    duration: 0.3,
                    ease: "power2.out"
                });
            });
            
            input.addEventListener('blur', () => {
                gsap.to(input, {
                    scale: 1,
                    duration: 0.3,
                    ease: "power2.out"
                });
            });
        });
        
        // Floating animation for icons
        gsap.to('.fa-calculator, .fa-heartbeat, .fa-chart-line, .fa-dumbbell', {
            y: -5,
            rotation: 5,
            duration: 2,
            repeat: -1,
            yoyo: true,
            ease: "power1.inOut"
        });

        // 3D card hover effects
        gsap.utils.toArray('.card-pro').forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                const rotateY = (x - centerX) / 20;
                const rotateX = (centerY - y) / 20;
                
                gsap.to(card, {
                    rotationY: rotateY,
                    rotationX: rotateX,
                    transformPerspective: 1000,
                    duration: 0.3,
                    ease: "power2.out"
                });
            });
            
            card.addEventListener('mouseleave', () => {
                gsap.to(card, {
                    rotationY: 0,
                    rotationX: 0,
                    duration: 0.5,
                    ease: "power3.out"
                });
            });
        });
        
        // Button hover animations
        gsap.utils.toArray('.btn-pro').forEach(button => {
            button.addEventListener('mouseenter', () => {
                gsap.to(button, {
                    scale: 1.05,
                    duration: 0.3,
                    ease: "power2.out"
                });
            });
            
            button.addEventListener('mouseleave', () => {
                gsap.to(button, {
                    scale: 1,
                    duration: 0.3,
                    ease: "power2.out"
                });
            });
        });
    });
</script>
{% endblock %}